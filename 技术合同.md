# 技术合同

## 一、标的技术的内容、范围及要求

1. 软件系统名称及开发目的  
本合同项下所开发的软件名称为：TRON分布式清算系统。该系统是随着比特币等数字加密货币的日益普及而逐渐兴起的一种全新的去中心化基础架构与分布式计算范式，分布式清算技术具有去中心化、时序数据、集体维护、可编程和安全可信等特点。目前已经引起政府部门、金融机构、科技企业和资本市场的高度重视与广泛关注。分布式清算受到了各国政府、团体组织、科技人才的广泛关注，积极探索区块链技术。
以Bitcoin、Ethereum为代表的分布式清算系统，各自建立了一套生态系统，但同时各自都存在一些安全和性能问题。TRON分布式清算系统是在分析现有区块链技术、研究现有区块链技术不足之后开发的一套全新的公链系统实现。 
2. 软件系统使用范围  
TRON分布式清算系统，是区块链技术领域中基础性的工程，可以理解为分布式计算机系统的操作系统，它为各类智能合约（Smart Contract）、去中心化应用（Decentralized Application）的运行提供基础组件。任何遵循Tron Protocol的节点都可以使用TRON分布式清算系统所提供的基础服务，任何组织和个人可以在TRON分布式清算系统之上部署智能合约和开发应用。
3.	软件系统开发内容  
TRON分布式清算系统一方面需要P2P网络的搭建，通过建立公共的通讯协议保障P2P网络中节点之间的信息沟通和数据流动。采用平台无关，语言无关，可扩展的序列化结构数据格式Protobuf作为底层的协议实现。

![](https://raw.githubusercontent.com/ybhgenius/TronDeployment/master/图片/1.png)

通过高效的节点发现机制保障P2P网络节点的参与性。开发基于分布式散列表原理和Kademlia算法作为基础发现算法保障网络节点的通信，使节点迅速构建网络拓扑结构；多维度多层次的节点评估机制负责维护节点的连接和断开，容忍部分节点的异常状态，保障P2P网络的鲁棒性；

通过节点数据同步和数据广播保障P2P网络节点所维护的数据一致性，保障节点之间对数据达成迅速共识。

![](https://raw.githubusercontent.com/ybhgenius/TronDeployment/master/图片/2.png)

从功能角度，TRON分布式清算系统分为以下子系统。P2P网络、智能合约及虚拟机、数据加密、区块浏览器、客户端钱包。

（1) P2P网络的搭建。

a. 区块数据产生：采用DPOS的共识算法保证区块的稳定快速生产。部署27个Witness 节点轮流进行区块生产，超过三分之二的Witness节点验证区块正确的情况下，将区块升级为固化块，从而保证区块的不可逆性和交易的不可变性。

b. Witness的动态选举性：支持TRX通证持有人进行Witness的投票功能，可以对不出块的Witness减少投票从而递补新的Witness节点保障区块的正常生产和交易打包。

c. Level DB存储：基于Level DB的数据存储技术，由于Level DB是Key-Value的数据实现保障了存取效率高的特性，同时将分叉区块进行逻辑上的暂存，在确定固化块时移除掉分叉的支链保障多层数据高效的存储和读取。

（2) 智能合约及虚拟机。

a.	开发转账合约：通证发行合约等基础合约功能。

![](https://raw.githubusercontent.com/ybhgenius/TronDeployment/master/图片/3.png)

b. 开发智能合约运行的虚拟机TVM：基于堆栈结构的TVM需要兼容各种编程语言，开发编译器生成可以被TVM理解的字节码。虚拟机提供字节打包优化功能，减少调用的资源消耗。

c. 开发智能合约的部署构建工具：对智能合约可以实现字节码的上链一键部署。

d. 开发智能合约的集成开发环境：支持solidity语言全版本的开发，web3.js的调用。Web deployment的开发，汇编码的反编译等功能。

e. 开发智能合约编译环境：支持solidity语言的编译。

f. 开发ABI接口生成工具：将字节码转换为二进制接口，部署到区块链上提供合约的调用。

![](https://raw.githubusercontent.com/ybhgenius/TronDeployment/master/图片/4.png)

（3）数据加密

a. 公钥/私钥对生成：基于椭圆曲线加密的非堆成加密算法，保障数据隐私和完全匿名。密钥长度为256位，可能的取值空间为2的256次方种可能。

b. 区块加密：基于默克尔树的区块链数据结构，每个区块的父哈希值为上个区块的哈希值，形成区块链，保障数据的不可篡改性，并实现零知识证明的特性。

![](https://raw.githubusercontent.com/ybhgenius/TronDeployment/master/图片/5.png)

c.	交易加密：基于账号的私钥对交易数据进行签名，当节点收到广播的交易信息后，根据节点的公钥进行解密验签，完成交易的合法性校验，防止双花问题的发生。

（4) 区块浏览器。

a. 检索区块：支持按照区块哈希值、区块高度、出块节点等多维度的方式进行检索。

b. 检索交易：支持按照交易哈希值、交易创建地址等维度方式进行检索。

c. 检索通证：支持按照通证创建地址、合约地址、通证名称方式进行检索。

d. Web版钱包：提供基于数据文件的登录方式、基于私钥的登录方式。

e. 节点投票功能：提供节点通过冻结资产的方式投票见证节点。

（5) 客户端钱包应用

a. 账号登录与信息展示：显示账号地址信息、交易信息、通证资产信息、投票信息、合约部署信息

b. 账号私钥找回：基于用户自定义助记词找回私钥。

c. 合约调用：为用户选择添加的智能合约暴露调用接口。

d. DApp使用：加载DApp的UI，提供便捷的用户使用接口。

上述子系统共同构成本合同所规定的软件系统。
 
4. 软件系统开发完成后的市场经济效益分析

随着分布式清算不断的认可及互联网联动的持续发展，高效率及高安全性的分布式清算技术将会成为社会的主流结算方式。TRON分布式清算系统是区块链技术中的基础性系统工程，建成之后可以在其上运行各类去中心化的应用，具有无穷的市场潜力，将吸引大量DApp开发者参与到TRON分布式清算系统生态建设中来，随之带来大量的用户。

TRON分布式清算系统将会提交市场的可信任性，TRON分布式清算系统可以提供天然可信的分布式账本平台；降低成本，跟传统技术相比，TRON分布式清算系统可以带来更短的时间、更少的人力，降低维护成本；增强安全，TRON分布式清算系统将有利于安全、可靠的审计管理和账目清算，减少犯罪风险。

## 二、软件开发程序语言及技术指标

如上所述，从系统结果角度，将TRON分布式清算系统划分为5个子系统，不同的子系统采用不同的技术架构并具有不同的技术指标要求。

1. P2P网络子系统  
P2P网络子系统提供TRON分布式清算系统系统网络拓扑、节点发现、数据同步的功能，是最为基础的功能。本系统采用Netty的技术架构组建完整的一套消息发送应答系统，实现高并发、低延迟的节点响应机制来处理节点同步和数据同步的功能。技术指标要求节点接入系统之后在1秒内发现到邻居节点并开始数据同步，在网络正常的情况数据源超过10个，高效的同步区块数据。
2. 智能合约及虚拟机子系统  
智能合约首先需要全面支持solidity语言，满足以太坊社区开发者的无缝对接，之后兼容其他的高级程序语言。采用编译字节码——发布ABI接口的技术架构保证智能合约的运行。技术指标要求智能合约的正确编译和正确运行。  
虚拟机子系统要求支持实现图灵完备的状态机，虚拟机子系统基于堆栈的技术结构。技术指标要求处理正确的字节操作码。
3. 数据加密子系统  
数据加密子系统负责区块数据、交易数据，账号公钥私钥数据的安全可靠性。技术架构采用基于椭圆曲线加密算法的非对称加密方式，具有加密强度高、解密效率高，加密数据小的特点。技术指标要求不存在暴力破解的可能，私钥的可穷举域超过10的77次方，远超世界超级计算机每秒算力10的18次方的运算能力，破解的时间为10的60次方秒（约合10的64次方年）。
4. 区块浏览器子系统  
区块浏览器子系统为用户提供方便的接口查询区块、交易、账号、智能合约等功能。技术上采用B/S的架构，采用异步的方式处理用户的查询需求，支持高并发的查询需求。技术指标要求至少百万QPS的查询，通过部署多台高性能服务器进行压力测试，模拟百万级用户的查询。
5. 客户端钱包子系统  
客户端钱包子系统为用户提供使用TRON分布式清算系统系统的平台，采用基于椭圆曲线的非对称加密的方式，保障账号的绝对安全性，客户端不存储任何私钥信息，私钥信息由用户进行离线保存，提供用户通过自定义助记词的方式找回私钥信息，实现绝对的去中心化。钱包还提供便捷的DApp搜索和添加功能，架起智能合约开发者和公链用户使用DApp的桥梁。技术指标要求客户端绝对的安全性和智能合约调用的易用性。

## 三、研究开发计划及阶段性目标
    
第一阶段：TRON分布式清算系统测试网上线及主网上线

开发基础P2P网络功能、数据存储功能、数据加解密功能、基础合约处理功能。完成基础P2P网络功能中节点的发现、邻居节点更新等功能的开发。完成区块数据、交易数据、账户数据的定义、加解密、存储功能的开发。完成基础P2P网络功能中节点的数据同步、数据广播功能的开发。完成创建交易、发行通证等基础合约处理功能的开发。

研发部署主网节点、切换主网版本配置文件，部署Witness节点，ERC20代币迁移。部署主网节点、切换主网版本配置文件。社区选出志愿节点作为27个Witness出块。根据节点的得票数切换Witness。和交易所对接，完成ERC20代币的迁移工作。

第二阶段：虚拟机功能测试网上线及主网上线

开发虚拟机TVM，部署测试合约到测试网测试，完成虚拟机TVM的开发，相关的部署工具开发。部署以太猫，fomo3d等流行的智能的智能合约进行测试。

研发主网上部署智能合约功能，部署多个智能合约，跟踪合约执行的情况，优化虚拟机的代码功能。

第三阶段：支持侧链及优化共识算法

研发侧链技术，完成侧链和TRON分布式清算系统的双向锚定。研发设计新的共识算法，支持更快的出块需求，满足高吞吐量。

第四阶段：虚拟机支持其他高级语言

研发支持c++、python、c等语言开发智能合约。

第五阶段：系统测试

按照甲方要求，对乙方的开发质量和开发进度进行测试和评估。依据甲方的产品规格说明书来测评乙方是否达到说明书的要求，测评结果包括对软件测试过程和测试用例的评估。

第六阶段：压力测试

甲方对委托乙方开发的5个子系统进行压力测试，测评乙方是否达到应具备的技术指标。另外，甲方有权检查乙方的测试用例，并进行审批，来确保系统已经达到应有的规格和技术指标。

